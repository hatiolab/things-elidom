<script src='../../../bower_components/jszip/dist/jszip.min.js'></script>

<link rel="import" href="../../../bower_components/polymer/polymer.html">

<link rel="import" href="./things-grid-config-behavior.html">
<link rel="import" href="./things-grid-pagination-behavior.html">
<link rel="import" href="./things-grid-export-behavior.html">
<link rel="import" href="./things-grid-import-behavior.html">
<link rel="import" href="./things-grid-addrow-behavior.html">
<link rel="import" href="./things-grid-soft-deleterow-behavior.html">
<link rel="import" href="./things-grid-save-behavior.html">

<script>

	window.Things = window.Things || {};

	/**
	 * 리소스 그리드 Behavior 
	 *
	 * @polymerBehavior Things.ResourceGridBehavior
	 */
	Things.ResourceGridBehaviorImpl = {

		properties: {

			/**
			 * Button Group에 표시될 버튼 정보
			 */
			buttons : {
				type: Array,
				value: function() {
					return [];
				}
			},

			/**
			 * 그리드 구성 전 발생하는 이벤트
			 *
			 * @event things-grid-configure
			 */
			/**
			 * 그리드 구성이 완료된 후 발생하는 이벤트
			 *
			 * @event things-grid-configured
			 */
			/**
			 * 그리드 구성 도중 에러가 발생한 경우 발생하는 이벤트
			 *
			 * @event things-grid-configure-failed
			 */
			/**
			 * 그리드 이벤트 Behavior 구성 전 발생하는 이벤트
			 *
			 * @event things-grid-event-configure
			 */
			/**
			 * 그리드 이벤트 Behavior 구성이 완료된 후 발생하는 이벤트
			 *
			 * @event things-grid-event-configured
			 */
			/**
			 * 그리드 Import Behavior 구성 전 발생하는 이벤트
			 *
			 * @event things-grid-import-configure
			 */
			/**
			 * 그리드 Import Behavior 구성이 완료된 후 발생하는 이벤트
			 *
			 * @event things-grid-import-configured
			 */
			/**
			 * 그리드 Export Behavior 구성 전 발생하는 이벤트
			 *
			 * @event things-grid-export-configure
			 */
			/**
			 * 그리드 Export Behavior 구성이 완료된 후 발생하는 이벤트
			 *
			 * @event things-grid-export-configured
			 */				 
			/**
			 * 그리드 Add Row Behavior 구성 전 발생하는 이벤트
			 *
			 * @event things-grid-addrow-configure
			 */
			/**
			 * 그리드 Add Row Behavior 구성이 완료된 후 발생하는 이벤트
			 *
			 * @event things-grid-addrow-configured
			 */
			/**
			 * 그리드 Soft Delete Row Behavior 구성 전 발생하는 이벤트
			 *
			 * @event things-grid-soft-deleterow-configure
			 */
			/**
			 * 그리드 Soft Delete Behavior 구성이 완료된 후 발생하는 이벤트
			 *
			 * @event things-grid-soft-deleterow-configured
			 */
			/**
			 * 그리드 Save Behavior 구성 전 발생하는 이벤트
			 *
			 * @event things-grid-save-configure
			 */
			/**
			 * 그리드 Save Behavior 구성이 완료된 후 발생하는 이벤트
			 *
			 * @event things-grid-save-configured
			 */
			/**
			 * 그리드 Pagination Behavior 구성 전 발생하는 이벤트
			 *
			 * @event things-grid-paginator-configure
			 */
			/**
			 * 그리드 Pagination Behavior 구성이 완료된 후 발생하는 이벤트
			 *
			 * @event things-grid-paginator-configured
			 */
			/**
			 * 그리드 Resize 전 발생하는 이벤트
			 *
			 * @event things-grid-resize
			 */
			/**
			 * 그리드 Resize 후 발생하는 이벤트
			 *
			 * @event things-grid-resized
			 */
			/**
			 * 그리드 Data 변경 전 발생하는 이벤트
			 *
			 * @event things-grid-data-change
			 */
			/**
			 * 그리드 Data 변경 후 발생하는 이벤트
			 *
			 * @event things-grid-data-changed
			 */
			/**
			 * 그리드 상세 버튼이 클릭 되었을 경우 발생하는 이벤트
			 *
			 * @event things-grid-detail-tap
			 */
			/**
			 * 그리드 Row Data가 선택되었을 경우 발생하는 이벤트
			 *
			 * @event things-grid-row-data-select
			 */
			/**
			 * 그리드 Cell Data가 선택되었을 경우 발생하는 이벤트
			 *
			 * @event things-grid-cell-data-select
			 */
			/**
			 * 그리드 데이터 Save(저장/삭제/추가) 액션이 성공시 발생하는 이벤트
			 *
			 * @event things-grid-save-success
			 */
			/**
			 * 그리드 데이터 Save(저장/삭제/추가) 액션시 에러 발생시 발생하는 이벤트
			 *
			 * @event things-grid-save-error
			 */
			/**
			 * 그리드 행 추가 전 발생하는 이벤트. 
			 * 이 이벤트를 잡아서 event.preventDefault()를 호출하고 별도 로직을 작성하면 기본 로직을 override 할 수 있다.
			 *
			 * @event things-grid-handle-addrow
			 */
			/**
			 * 그리드 행 삭제 전 발생하는 이벤트. 
			 * 이 이벤트를 잡아서 event.preventDefault()를 호출하고 별도 로직을 작성하면 기본 로직을 override 할 수 있다.
			 *
			 * @event things-grid-handle-deleterow
			 */
			/**
			 * 그리드 Save(저장/삭제/추가) 로직 수행 전 발생하는 이벤트. 
			 * 이 이벤트를 잡아서 event.preventDefault()를 호출하고 별도 로직을 작성하면 기본 로직을 override 할 수 있다.
			 *
			 * @event things-grid-pre-save
			 */
			/**
			 * 그리드 Import 로직 수행 전 발생하는 이벤트. 
			 * 이 이벤트를 잡아서 event.preventDefault()를 호출하고 별도 로직을 작성하면 기본 로직을 override 할 수 있다.
			 *
			 * @event things-grid-handle-import
			 */
			/**
			 * 그리드 Import 완료 후 발생하는 이벤트. 
			 *
			 * @event things-grid-import-finished
			 */
			/**
			 * 그리드 Export 수행 전 발생하는 이벤트. 
			 * 이 이벤트를 잡아서 event.preventDefault()를 호출하고 별도 로직을 작성하면 기본 로직을 override 할 수 있다.
			 *
			 * @event things-grid-handle-export
			 */
		},

		listeners: {
			'things-grid-configure-failed' : '_gridConfigureFailed'
		},

		observers: [
			'_toolbarConfigChanged(paginatable, buttons)'
		],

		/**
		 * 툴바 관련 설정 변경시 
		 *
		 * @param {Boolean} paginatable
		 * @param {Array} buttons
		 */
		_toolbarConfigChanged: function(paginatable, buttons) {
			this.enableToolbar = (paginatable || (buttons && buttons.length > 0));
		},

		/**
		 * Grid 구성이 실패한 후 핸들러
		 * 
		 * @param {Object} event things-grid-configure-failed 이벤트 
		 */
		_gridConfigureFailed: function(event) {
			var title = 'Grid Configuration Error';
			var text = 'Error : ' + event.detail.error;
			this.openInfoMsg({ type : 'error', title : title, text : text });
		}
		
	};

  Things.ResourceGridBehavior = [
    Things.ResourceGridBehaviorImpl,
		Things.GridConfigBehavior,
		Things.GridPaginationBehavior,
		Things.GridImportBehavior,
		Things.GridExportBehavior,
		Things.GridAddrowBehavior,
		Things.GridSoftDeleterowBehavior,
		Things.GridSaveBehavior
  ];

</script>