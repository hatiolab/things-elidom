<script src='../../../bower_components/jszip/dist/jszip.min.js'></script>

<link rel="import" href="../../../bower_components/polymer/polymer.html">

<script>

	window.Things = window.Things || {};

	/**
	 * 그리드 정보를 Excel로 Export 하는 기능을 제공하는 그리드 Behavior
	 */
	Things.GridExportBehavior = {

		properties: {
			/**
			 * Export 파일 이름 
			 */
			exportFileName: {
				type: String
			},

			/**
			 * Export 파일 Sheet 이름 
			 */
			exportSheetName: {
				type: String
			}
		},

		listeners: {
			'things-grid-configured': '_initializeExportHandler'
		},

		/**
		 * 그리드 구성이 완료된 후 GridExportBehavior를 initialize 한다.
		 *
		 * @event {Event} e
		 */
		_initializeExportHandler: function(e) {
			var evt = this.fire('things-grid-export-configure', this.grid, { cancelable: true });
			if(!evt.defaultPrevented) {
				// TODO 
				this.fire('things-grid-export-configured', this.grid);
			}
		},

		/**
		 * Export excel
		 */
		exportGrid: function() {
			var evt = this.fire('things-grid-handle-export', e.detail, { cancelable: true });
			if(!evt.defaultPrevented) {
				new DataLudi.GridExcelExporter().export(this.grid, {
					target: 'local',
					fileName: this.exportFileName,
					numberFormat: '#,##0.00',
					datetimeFormat: 'yyyy.mm.dd'
				});

				// TODO listen export-finish event and fire event
			}
		}

	};

</script>