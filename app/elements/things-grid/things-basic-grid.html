<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-resizable-behavior/iron-resizable-behavior.html">
<link rel="import" href="../../../bower_components/paper-toolbar/paper-toolbar.html">

<link rel="import" href="../things-paginator/things-paginator.html">
<link rel="import" href="./things-grid-basic-behavior.html">

<!--
기본 그리드. 그리드 데이터를 표시하기만 하는 그리드

pagination을 지원하고 데이터를 표시한 후 저장이나 삭제 등의 트랜잭션 기능은 없다.

Example:

	<things-basic-grid></things-basic-grid>

Example:

	<things-basic-grid>
	  <h2>Hello my-elem</h2>
	</things-basic-grid>

@demo ./things-grid/demo/demo-things-basic-grid.html
-->

<dom-module id="things-basic-grid">
	<template>
		<style>
			:host {
				display: block;
				height: 100%;
				width: 100%;
				padding: 10px 0px 0px 0px;
			}
		</style>
	
		<div id="gridContainer"></div>

		<paper-toolbar class="white">
			<div class="bottom fit">
				<things-paginator 
					per-page="{{limit}}" 
					current-page="{{page}}" 
					total-count="{{totalCount}}"
					page-start-idx="{{pageStartIdx}}"
					page-end-idx="{{pageEndIdx}}">
				</things-paginator>
			</div>
		</paper-toolbar>

	</template>

	<script>
		Polymer({
			is: 'things-basic-grid',

			behaviors: [
				Things.GridBasicBehavior
			],
	
			properties: {
			},

			created: function() {
				DataLudi.setRootContext('');
				DataLudi.setAssetRoot('images/grid');
			},

			detached: function() {
				this.clearGrid();
			},			

			/**
			 * register grid event
			 */
			registerGridEvent: function() {
				var me = this;

				this.grid.onDataCellClicked = function (grid, indexObj) {
					if (indexObj && indexObj.dataColumn() && indexObj.getDataIndex(grid) >= 0) {
						var rowIndex = indexObj.getDataIndex(grid);
						var colIndex = indexObj.dataField();
						me._gridCellClicked(rowIndex, colIndex, indexObj);
					}
				};
			},

			/**
			 * grid cell click handler
			 * @event things-grid-detail-clicked
			 */
			_gridCellClicked: function(rowIndex, colIndex, indexObj) {
				console.log(indexObj);
				var row = this.grid.focusedRow();
				if (row && row.dataIndex() >= 0) {
					this.selectedRowData = row.getRowObject();
				}

				if(this.enableDetailColumn && indexObj.dataField() < 0) {
					this.onDetailClicked();
					this.fire('things-grid-detail-clicked', this.selectedRowData);
				} else {
					this.selectedCellData = this.dataSet.getValue(rowIndex, colIndex);
				}
			}

		});
	</script>
</dom-module>