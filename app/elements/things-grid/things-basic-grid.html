<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-resizable-behavior/iron-resizable-behavior.html">
<link rel="import" href="../../../bower_components/paper-toolbar/paper-toolbar.html">

<link rel="import" href="../things-paginator/things-paginator.html">
<link rel="import" href="./things-grid-basic-behavior.html">

<!--
기본 그리드. 그리드, 그리드 모델, 그리드 컬럼에 대한 설정을 통해 그리드를 표시한다.

pagination을 지원하고 데이터를 표시한 후 저장이나 삭제 등의 트랜잭션 기능은 없다.

	Example:

	  <things-resource 
	    auto
	    action="diy_services/ElidomGridModel/query.json" 
	    last-response="{{gridModel}}">
	  </things-resource>

	  <things-resource 
	    auto
	    action="diy_services/ElidomGridColumn/query.json" 
	    last-response="{{gridColumns}}">
	  </things-resource>

	  <things-resource 
	    id="search-resource"
	    action="terminologies" 
	    method="GET"
	    last-response="{{gridData}}">
	  </things-resource>

	  <things-basic-grid 
	    id="grid"
	    grid-model="[[gridModel]]" 
	    columns="[[gridColumns]]" 
	    read-data="[[gridData]]"
	    page="{{page}}"
	    limit="{{limit}}"
	    root-property="items"
	    total-property="total"
	    selected-row-data="{{selectedRow}}"
	    page-start-idx="{{pageStartIdx}}"
	    page-end-idx="{{pageEndIdx}}">
	  </things-basic-grid>

@demo ./things-grid/demo/demo-things-basic-grid.html
-->

<dom-module id="things-basic-grid">
	<template>
		<style>
			:host {
				display: block;
				height: 100%;
				width: 100%;
				padding: 10px 0px 0px 0px;
			}
		</style>
	
		<div id="{{gridContainerId}}"></div>

		<paper-toolbar class="white" hidden$="{{!enableToolbar}}">

			<div id="gridToolbar" class="bottom fit" hidden$="{{!paginatable}}">
				<things-paginator
					id ="paginator"
					per-page="{{perPage}}" 
					current-page="{{currentPage}}" 
					total-count="[[totalCount]]"
					page-start-idx="[[pageStartIdx]]"
					page-end-idx="[[pageEndIdx]]">
				</things-paginator>

				<content id="toolbarContent" select=".grid-toolbar-content"></content>
			</div>
		</paper-toolbar>

	</template>

	<script>
		Polymer({
			is: 'things-basic-grid',

			behaviors: [
				Things.GridBasicBehavior
			],
	
			properties: {
				/**
				 * use page nate or not
				 */
				paginatable: {
					type: Boolean,
					value: false
				},

				/**
				 * page limit
				 * @type {Object}
				 */
				perPage: {
					type: Number,
					notify: true
				},

				/**
				 * current page
				 */
				currentPage: {
					type: Number,
					notify: true
				},

				/**
				 * total data count
				 */
				totalCount: {
					type: Number,
					notify: true
				},

				/**
				 * if enable toolbar or not
				 */
				enableToolbar: {
					type: Boolean,
					value: false
				},

				/**
				 * 그리드 footer를 보여줄 지 여부 
				 */
				showGridFooter: {
					type: Boolean,
					value: false
				}				

				/**
				 * 그리드가 구성되고 난 후 fire
				 *
				 * @event things-basic-grid-configured
				 */
				/**
				 * 그리드 Row Data가 선택되었을 경우 fire
				 *
				 * @event things-grid-row-data-select
				 */
				/**
				 * 그리드 Cell Data가 선택되었을 경우 fire
				 *
				 * @event things-grid-cell-data-select
				 */
				/**
				 * 그리드 Cell 중에 Detail 아이콘이 선택되었을 경우 fire
				 *
				 * @event things-grid-detail-tap
				 */
			},

			created: function() {
				// 핸들링하고자 하는 grid event를 설정한다. { grid event 명 : 'event handler 명' }
				this.events = {
					onDataCellClicked : '_gridCellClicked',
					onScrollToBottom :'_gridScrollToBottom'
				};

				DataLudi.setRootContext('');
				DataLudi.setAssetRoot('../../../images/grid');
			},

			detached: function() {
				this.clearGrid();
			},

			/**
			 * grid 구성 후 추가 액션 
			 */
			afterGridInitiated: function() {
				this.grid.footer().setVisible(this.showGridFooter);
				this.fire('things-basic-grid-configured', this.grid);
			}

		});
	</script>
</dom-module>