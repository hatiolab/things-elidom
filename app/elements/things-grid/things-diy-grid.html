<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-resizable-behavior/iron-resizable-behavior.html">
<link rel="import" href="../../../bower_components/paper-toolbar/paper-toolbar.html">

<link rel="import" href="../things-paginator/things-paginator.html">
<link rel="import" href="./things-resource-grid.html">

<!--
DiyGrid 서비스를 통하여 제공하는 기본 그리드. 그리드 형태만 표시되고 그리드 데이터는 외부에서 별도로 data attribute로 설정해주면 된다.

pagination을 지원하고 데이터를 표시한 후 저장이나 삭제 등의 트랜잭션 기능은 없다.

	Example:
	
    <section>
      <things-diy-grid 
        id="grid"
        resource-meta-url="diy_grids/2.json"
        data="[[gridData.items]]"
        paginatable
        total-count ="[[gridData.total]]"
        current-page="{{currentPage}}"
        per-page="{{perPage}}"
        page-start-idx="{{pageStartIdx}}"
        page-end-idx="{{pageEndIdx}}"
        selected-row-data="{{selectedRow}}">
      </things-diy-grid>

      <things-resource 
        id="search-resource"
        resource="diy_services/DynamicScreen/query.json"
        action=""
        method="GET"
        content-type="application/json"
        last-response="{{gridData}}">
      </things-resource>
    </section>

@demo ./things-grid/demo/demo-things-diy-grid.html
-->

<dom-module id="things-diy-grid">
	<template>
		<style>
			:host {
				display: block;
				height: 100%;
				width: 100%;
				padding: 10px 0px 0px 0px;
			}
		</style>
		
		<things-resource 
			id="resource-meta"
			auto
			method="GET"
			action="[[resourceMetaUrl]]"
			last-response="{{metaData}}">
		</things-resource>

		<things-resource-grid
			id="grid"
			model="[[metaData.fields]]" 
			columns="[[metaData.columns]]"
			config ="[[metaData.config]]"
			data="[[data]]"
			appending="[[appending]]"
			total-count ="[[totalCount]]"
			current-page="{{currentPage}}"
			per-page="{{perPage}}"
			paginatable="[[paginatable]]"
			grid-save-action="[[gridSaveUrl]]"
			selected-row-data="{{selectedRow}}"
			export-file-name="[[title]]"
			export-sheet-name="[[title]]"
			enable-detail-column ="[[enableDetailColumn]]">
		</things-resource-grid>

	</template>

	<script>
		Polymer({
			is: 'things-diy-grid',

			properties: {
				/**
				 * Boolean need to set false as defualt
				 */
				enableDetailColumn: {
					type: Boolean,
					value: false
				},

				/**
				 * things resource meta url
				 */
				resourceMetaUrl: {
					type: String
				},

				/**
				 * grid data
				 */
				data: {
					type: Object
				},

				/**
				 * selected row data
				 */
				selectedRow: {
					type: Object
				},

				/**
				 * grid Save Url
				 */
				gridSaveUrl: {
					type: String
				},

				/**
				 * use page nate or not
				 */
				paginatable: {
					type: Boolean,
					value: false
				},

				/**
				 * page limit
				 * @type {Object}
				 */
				perPage: {
					type: Number,
					value: 100,
					notify: true
				},

				/**
				 * current page
				 */
				currentPage: {
					type: Number,
					value: 1,
					notify: true
				},

				/**
				 * total data count
				 */
				totalCount: {
					type: Number,
					notify: true
				},

				/**
				 * enable toolbar
				 */
				enableToolbar: {
					type: Boolean,
					value: false
				},
				
			 /**
				* data load mode
				* @type {Object}
				*/
				appending: {
					type: Boolean,
					value: false
				},

			 /**
				* grid save url
				* @type {Object}
				*/
				gridSaveUrl: {
					type: String
				}

				/**
				 * 그리드 Row Data가 선택되었을 경우 fire
				 *
				 * @event things-grid-row-data-select
				 */
				/**
				 * 그리드 Cell Data가 선택되었을 경우 fire
				 *
				 * @event things-grid-cell-data-select
				 */
				/**
				 * 그리드 데이터 Save(저장/삭제/추가) 액션이 성공했을 경우 fire
				 *
				 * @event things-grid-save-success
				 */
				/**
				 * 그리드 데이터 Save(저장/삭제/추가) 액션시 에러가 발생 했을 경우 fire
				 *
				 * @event things-grid-save-error
				 */
				/**
				 * 그리드 detail이 클릭 되었을 경우 
				 * @event things-grid-detail-tap
				 */	
			}

		});
	</script>
</dom-module>