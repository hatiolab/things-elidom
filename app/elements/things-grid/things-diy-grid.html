<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-resizable-behavior/iron-resizable-behavior.html">
<link rel="import" href="../../../bower_components/paper-toolbar/paper-toolbar.html">

<link rel="import" href="../things-paginator/things-paginator.html">
<link rel="import" href="./things-resource-grid.html">

<!--
서버에서 관리하는 DiyGrid 정보를 조회해서 그리드를 구성하는 동적 그리드. 

	Example:

	  <things-diy-content 
	  	menu-id="1"
			data-route="users"
			current-route="[[route]]"
			resource-url="users"
			layout="fullbleed layout vertical">
		</things-diy-content>	

@demo ./things-grid/demo/demo-things-diy-grid.html
-->

<dom-module id="things-diy-grid">
	<template>
		<style>
			:host {
				display: block;
				height: 100%;
				width: 100%;
				padding: 10px 0px 0px 0px;
			}
		</style>
		
		<things-resource 
			id="resource-meta"
			method="GET"
			action="[[resourceMetaUrl]]"
			last-response="{{metaData}}">
		</things-resource>

		<things-resource-grid
			id="grid"
			model="[[metaData.fields]]" 
			columns="[[metaData.columns]]"
			config ="[[metaData.config]]"
			data="[[data]]"
			appending="[[appending]]"
			total-count ="[[totalCount]]"
			current-page="{{currentPage}}"
			per-page="{{perPage}}"
			pagenatable="[[pagenatable]]"
			enableDetailColumn="[[enableDetailColumn]]"
			grid-save-action="[[gridSaveUrl]]"
			selected-row-data="{{selectedRow}}"
			export-file-name="[[title]]"
			export-sheet-name="[[title]]"
			enable-detail-column ="[[enableDetailColumn]]">
		</things-resource-grid>

	</template>

	<script>
		Polymer({
			is: 'things-diy-grid',

			properties: {
				/**
				 * Boolean need to set false as defualt
				 */
				enableDetailColumn: {
					type: Boolean,
					value: false
				},

				/**
				 * things resource meta url
				 */
				resourceMetaUrl: {
					type: String
				},

				/**
				 * grid data
				 */
				data: {
					type: Object
				},

				/**
				 * selected row data
				 */
				selectedRow: {
					type: Object
				},

				/**
				 * grid Save Url
				 */
				gridSaveUrl: {
					type: String
				},

				/**
				 * use page nate or not
				 */
				pagenatable: {
					type: Boolean,
					value: false
				},

				/**
				 * page limit
				 * @type {Object}
				 */
				perPage: {
					type: Number,
					notify: true
				},

				/**
				 * current page
				 */
				currentPage: {
					type: Number,
					notify: true
				},

				/**
				 * total data count
				 */
				totalCount: {
					type: Number,
					notify: true
				},

				/**
				 * enable toolbar
				 */
				enableToolbar: {
					type: Boolean,
					value: false
				},

				/**
				* data load mode
				* @type {Object}
				*/
				appending: {
					type: Boolean,
					value: false
				},
				
				/**
				* grid save url
				* @type {Object}
				*/
				gridSaveUrl: {
					type: String
				}

				/**
				 * 그리드 Row Data가 선택되었을 경우 fire
				 *
				 * @event things-grid-row-data-select
				 */
				/**
				 * 그리드 Cell Data가 선택되었을 경우 fire
				 *
				 * @event things-grid-cell-data-select
				 */
				/**
				 * 그리드 데이터 Save(저장/삭제/추가) 액션이 성공했을 경우 fire
				 *
				 * @event things-grid-save-success
				 */
				/**
				 * 그리드 데이터 Save(저장/삭제/추가) 액션시 에러가 발생 했을 경우 fire
				 *
				 * @event things-grid-save-error
				 */
				/**
				 * 그리드 detail이 클릭 되었을 경우 
				 * @event things-grid-detail-tap
				 */	
			},

			/**
			 * Diy Grid의 Configuration 정보를 다시 가져온다.
			 * 이 정보를 다시 가져온 후 그리드는 다시 구성된다.
			 */
			refreshMeta: function() {
				this.$['resource-meta'].generateRequest();
			}

		});
	</script>
</dom-module>