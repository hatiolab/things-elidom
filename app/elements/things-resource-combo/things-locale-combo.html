<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-localstorage/iron-localstorage.html">

<link rel="import" href="things-code-combo.html">

<!--
다국어 설정을 위한 Locale Selector 

Example:

  <things-locale-combo 
		id="locale-selector" 
		storage-name="setting.locale" 
		default-locale="{{globals.locale}}">
  </things-locale-combo>

@demo demo/index.html
-->

<dom-module id="things-locale-combo">
	<template>
		<style>
			:host {
				display: block;
			}
		</style>

		<things-code-combo 
			id="code-selector" 
			label="Language" 
			value="[[defaultLocale]]" 
			code-name="LOCALE" 
			label-path="description" 
			value-path="name">
		</things-code-combo>

		<iron-localstorage name="[[storageName]]" value="{{selectedLocale}}"></iron-localstorage>
	</template>

	<script>
		Polymer({
			is: 'things-locale-combo',

			properties: {
				/**
				 * Local Storage Name
				 */
				storageName: {
					type: String,
					value: 'setting.locale'
				},

				/**
				 * Default Locale
				 */
				defaultLocale: {
					type: String
				},

				/**
				 * 선택된 Locale 값 
				 */
				selectedLocale: {
					type: String
				}
			},

			listeners: {
				'code-selector.things-combo-value-changed' : '_onComboValueChanged'
			},

			/**
			 * Combo 값이 변경될 때 
			 */
			_onComboValueChanged: function(event) {
				this.set('selectedLocale',event.detail.value);
				if(window.I18nMsg)
				{
					I18nMsg.lang = dataGlobal.language || document.documentElement.lang
					I18nMsg.lang = event.detail.value;
				}
				Platform.performMicrotaskCheckpoint();
			},

			/**
			 * 선택된 Locale 값을 리턴 
			 */
			getLocale: function() {
				return this.selectedLocale
			}

		});
	</script>
</dom-module>