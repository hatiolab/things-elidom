<link rel="import" href="../../../bower_components/polymer/polymer.html">

<link rel="import" href="./things-combo.html">

<dom-module id="things-code-selector">
	<template>

    <things-combo 
      id="combo" 
      name="{{name}}" 
      label="{{label}}" 
      value="{{value}}" 
      items="{{items}}" 
      label-path="{{labelPath}}" 
      value-path="{{valuePath}}">
    </things-combo>

    <things-resource
      auto
      id="resource" 
      action="{{computeUrl(codeName)}}" 
      method="GET" 
      root-property="items"
      outout-data="{{items}}">
    </things-resource>

	</template>

  <script type="text/javascript">
  	(function() {
      Polymer({
        is: "things-code-selector",

        properties: {
          codeName: {
            type: String,
            notify: true
          }
        },

        listeners: {
          'resource.response' : 'onResponse'
        },        

        computeUrl: function(codeName) {
          return 'common_codes/show_by_name?name=' + codeName;
        },

        onResponse: function(e) {
          this.items = e.detail;
        }

      })
  	})();
  </script>
</dom-module>
