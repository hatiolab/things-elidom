<link rel="import" href="../../../bower_components/polymer/polymer.html">

<link rel="import" href="../../../bower_components/vaadin-combo-box/vaadin-combo-box.html">
<!--link rel="import" href="../../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../../bower_components/paper-menu/paper-menu.html">
<link rel="import" href="../../../bower_components/paper-dropdown-menu/paper-dropdown-menu.html"-->

<dom-module id="things-combo">
	<template>
    <!--paper-dropdown-menu id="combo" label="{{label}}" value="{{value}}">
      <paper-menu class="dropdown-content" selected="{{findSelected(value)}}">
        <template is="dom-repeat" items="{{items}}">
          <paper-item value="{{item.name}}">{{item.description}}</paper-item>
        </template>
      </paper-menu>
    </paper-dropdown-menu-->

    <vaadin-combo-box 
      id="combo" 
      label="{{label}}" 
      items="{{items}}" 
      item-label-path="{{labelPath}}" 
      item-value-path="{{valuePath}}" 
      value="{{value}}">
    </vaadin-combo-box>

	</template>

  <script type="text/javascript">
  	(function() {
      Polymer({
        is: "things-combo",

        properties: {
          items: {
            type: Array,
            notify: true,
            value: []
          },

          value: {
            type: String,
            value: 'zh-CN'
          }
        },

        /*listeners: {
          'combo.iron-select' : 'onComboSelected',
          'combo.iron-deselect' : 'onComboDeselected'
        },*/

        listeners: {
          'combo.selected-item-changed' : 'onComboSelected',
          'combo.value-changed' : 'onComboDeselected'
        },

        /*findSelected: function (value) {
          for(var i = 0; i < this.items.length; i++) {
            if(this.items[i].value == value) {
              return i;
            }
          }

          return 0;
        },*/

        onComboSelected: function(e) {
          if(e.detail.value && this.valuePath) {
            this.fire('select', this._makeEventData(e));
          }
        },

        onComboDeselected: function(e) {
          if(e.detail.value && this.valuePath) {
            this.fire('deselect', this._makeEventData(e));
          }
        },

        _makeEventData: function(e) {
          var detail = {};
          detail[this.labelPath] = e.detail.value[this.labelPath];
          detail[this.valuePath] = e.detail.value[this.valuePath];
          return detail;
        }

      })
  	})();
  </script>
</dom-module>
