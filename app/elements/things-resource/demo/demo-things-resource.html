<!doctype html>
<!--
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<html>
<head>

  <title>things-resource</title>

  <script src="../../../../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="import" href="../../../../bower_components/paper-input/paper-input.html">
  <link rel="import" href="../../../../bower_components/paper-input/paper-textarea.html">
  <link rel="import" href="../../../../bower_components/paper-styles/demo-pages.html">

  <link rel="import" href="../../things-button/things-button.html">
  <link rel="import" href="../../things-spinner/things-spinner.html">
  <link rel="import" href="../../things-setting/things-setting.html">
  <link rel="import" href="../things-resource.html">

  <style>
    iron-image {
      background-color: lightgray;
      margin: 1em;
    }
    .horizontal-section {
      max-width: 300px;
      margin-bottom: 24px;
    }
  </style>
</head>

<body unresolved>
  <h1>Things Resource</h1>

  <dom-module id="sample-things-resource">
    <template>
      <things-setting id="setting"></things-setting>

      <things-resource
        id="ajax"
        action="{{invokeUrl}}"
        params='{"page":1, "limit": 10}'
        handle-as="json"
        last-response="{{ajaxResponse}}">
      </things-resource>

      <form>
        <paper-button raised on-tap="invoke">invoke</paper-button>
        <paper-button raised on-tap="reset">reset</paper-button>

        <paper-input required id="invoke-url" label="Invoke URL" value="{{invokeUrl}}">
        </paper-input>

        <paper-textarea id="result" label="Result" rows=16></paper-textarea>
      </form>
    </template>

    <script>
      Polymer({
        is: 'sample-things-resource',

        properties: {
          invokeUrl : {
            type: String,
            value: 'terminologies'
          },

          ajaxResponse: {
            type: Object,
            observer: '_responseChanged'
          }
        },

        invoke: function() {
          this.$.ajax.generateRequest();
        },

        reset: function() {
          this.$.result.value = '';
        },

        _responseChanged: function(ajaxResponse) {
          if(ajaxResponse && ajaxResponse.items) {
            this.$.result.value = JSON.stringify(ajaxResponse.items, null, 4);
          } else {
            this.reset();
          }
        }
      });
    </script>
  </dom-module>

  <template is="dom-bind" id="app">
    <section>
      <sample-things-resource></sample-things-resource>
    </section>  

    <things-spinner id="spinner" loading=false></things-spinner>
  </template>

  <script>
    var app = document.querySelector('#app');

    app.invoke = function() {
      app.$.ajax.generateRequest();
    };
  </script>
</body>
</html>
